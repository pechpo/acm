华山派掌门岳不群想考验大弟子令狐冲的品格。作为五岳剑派的掌门人之一，他自然拥有大量的武林侠客的生平资料，并想通过这些数据来推断令狐冲究竟是好人还是坏人。
数据推断是在大量数据基础上进行预测。具体地，数据推断的任务可以看作设定m个特征，通过前m-1个特征的取值推断出最后一个特征的取值。
作为一个聪明人，岳不群采用了图的方式对特征进行建模。详细来说，特征之间的关系可以表示为一个有向无环图，其中指向结点B的结点A表示B是一个依赖于A的随机变量。
现在，给出n条特征数据，岳不群想知道，通过数据的频率建模出概率关系后，给出令狐冲的前m-1个特征，其第m个特征的概率分布。

第一行由一个整数T构成，表示数据的组数。
第二行由两个整数n,m构成，表示数据的个数和特征数。
在接下来的n行，每行包含m个整数，表示该人士的各项特征的取值。
在最后一行，有m-1个整数，表示令狐冲的前m-1个特征的取值。

一个整数，表示令狐冲的第m项特征最可能的取值

华山派掌门岳不群想考验弟子林平之的品格。不过这一次，他想用更精确的方法。
具体地，给出一系列前提，他想用自己的推理系统来进行推理，得出某个有关林平之品格的结论。这个系统由以下符号组成。
这个推理系统还包括一些概念，如项、原子公式、合式公式，以及自由出现、约束出现。在这些概念的基础上，我们可以定义某个项t能否替换某个变元x，这是进行推理的基础之一。
现在，岳不群想通过编程完成对替换可能性的判断。

第一行给出一个公式A。
第二行由一个整数q组成，表示q个询问。
接下来有q行，每行由一个项t以及一个变元x组成，表示询问对于公式A，项t能否替换变元x。

一个长为q的字符串，其中第i位字符为Y/N，分别表示第i个询问可替换/不可替换。

华山派掌门岳不群邀请各路武林高手前往华山思过崖崖顶，观摩石刻武功秘诀。令狐冲和他的女友任盈盈也在邀请之列。其中，华山的前辈们在一个大山洞里刻下了密密麻麻的武林绝学。
不幸的是，山洞内部有大量机关，因此难以进入；幸运的是，山洞在转角处被开出了若干窗口，可以通过窗口窥视山洞内壁的武功文字。
大山洞可以看作是一个多边形，其中许多顶点作为了窗口。
从某个特定的窗口看进去的过程中，多边形的边可能与视线平行，此时就难以看到内壁上的文字。此时，令狐冲正因回到与前女友岳灵珊的羁绊之地而闷闷不乐，难以想出解决办法。此时，任盈盈告诉他可以通过在窗口边进行小幅移动来使得内壁与视线不再平行。
现在，令狐冲想知道，通过从所有窗口中窥视，所能看到总内壁长度是多少。

第一行给出两个整数n,m，表示多边形的顶点数和窗口的数量。
接下来由n行组成，每行给出两个整数x,y，表示对应点的坐标。
接下来一行给出m个整数，表示窗口的编号。

输出所能看到的总长度。